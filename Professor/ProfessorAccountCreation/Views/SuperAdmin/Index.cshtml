@using System.Globalization
@{
    TextInfo textInfo = CultureInfo.CurrentCulture.TextInfo;
}

@model IEnumerable<ProfessorAccountCreation.Models.Professor>
@{
    ViewData["Title"] = "Prof Admin Dashboard";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>@ViewData["Title"]</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="~/css/superadmin.css" />
    <script src="~/js/idleLogout.js"></script>
    
</head>
<body>

    <!---BAGONG VERSION ITO--->
    <div class="container">
        <div class="dashboard-header">
            <h2>Prof Admin Dashboard</h2>
            <a asp-controller="SuperAdmin" asp-action="Logout" class="btn btn-logout">Logout</a>
        </div>

        <div class="filter-search">
            <form asp-action="Index" method="get" style="flex:1; display:flex; gap:0.5rem;">
                <select name="department" onchange="this.form.submit()">
                    @{
                        var dept = ViewBag.SelectedDepartment ?? "All";
                    }
                    <option value="All" selected="@(dept == "All")">All Departments</option>
                    <option value="Entrepreneurship" selected="@(dept == "Entrepreneurship")">Entrepreneurship</option>
                    <option value="Information Technology" selected="@(dept == "Information Technology")">Information Technology</option>
                    <option value="General Education" selected="@(dept == "General Education")">General Education</option>

                </select>
                <input type="text" name="search" placeholder="Search by name or email" value="@ViewBag.Search" />
                <button type="submit" class="btn btn-add">Filter/Search</button>
            </form>
            <a asp-controller="Register" asp-action="Index" class="btn btn-add">+ Add Professor</a>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Last Name</th>
                    <th>First Name</th>
                    <th>Middle Name</th>
                    <th>Email</th>
                    <th>Department</th>
                    <th>Faculty Type</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Any())
                {
                    foreach (var p in Model)
                    {
                        <tr>
                            <td>@textInfo.ToTitleCase(p.LastName.ToLower())</td>
                            <td>@textInfo.ToTitleCase(p.GivenName.ToLower())</td>
                            <td>@textInfo.ToTitleCase((p.MiddleName ?? "").ToLower())</td>
                            <td>@p.Email</td>
                            <td>@string.Join(", ", p.Programs.Select(pr => textInfo.ToTitleCase(pr.ToLower())))</td>

                            <td>
                                @(string.IsNullOrEmpty(p.FacultyRole)
                                                        ? "—"
                                                        : textInfo.ToTitleCase(p.FacultyRole.ToLower()))
                            </td>

                            <td>
                                <a asp-action="Edit" asp-route-id="@p.Id" class="btn btn-edit">Edit</a>
                                <form asp-action="Delete" method="post" style="display:inline;">
                                    <input type="hidden" name="id" value="@p.Id" />
                                    <button type="submit" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this professor?');">Delete</button>
                                </form>
                            </td>

                        </tr>
                    }
                }
                else
                {
                    <tr><td colspan="6" style="text-align:center;">No professors found.</td></tr>
                }
            </tbody>
        </table>

        <ul class="pagination">
            @for (int i = 1; i <= ViewBag.TotalPages; i++)
            {
                <li>
                    <a href="@Url.Action("Index", new { page=i, department=ViewBag.SelectedDepartment, search=ViewBag.Search })" class="@(ViewBag.Page==i?"active":"")">@i</a>
                </li>
            }
        </ul>
    </div>
</body>
</html>
